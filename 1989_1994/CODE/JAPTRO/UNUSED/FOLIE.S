	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ	#6,SP
	
	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	MOVE.L	#BUFFER,D0
	CLR.B	D0
	MOVE.L	D0,SCREEN1
	ADD.L	#32000,D0
	MOVE.L	D0,SCREEN2

**********
	;A0=BUFFER DELTAPACK (IMAGE)
	;A1=TABLE DES 256 ROUTINES
	;A6=ADR ECRAN
	;D7=%11111111
	;D6=%00001111
	;D5=%11110000

;	MOVE.B	(A0)+,D0	2
;	ADD	D0,D0	1
;	ADD	D0,D0	1
;	JMP	(A1,D0.W)	4?

	;EX DE ROUTINE SI D0=%11100101=%11 10 01 01
;	OR.B	D7,(A6)	CA EN FAIT 2
;	OR.B	D5,1(A6)	+1
;	OR.B	D6,8(A6)
;	OR.B	D6,8+1(A6)
;	LEA	16(A6),A6	2
;	=4*4 NOPS...+2
;ESTIMATION: 4 ORS+1 LEA=4*4+4 OCTETS => 20*256=5K. RIDICULE.
;( UN PEU MOINS, EN FAIT )

;ESTIMATION: 1 LIGNE=80 PIX *4
;80/8=10 APPELS --- 10*16=160 PIX, CORRECT
;TEMPS MAX: (8+16+2)*10=260 NOPS
;
;CECI POUR 50 LIGNES. SOIT 50*260=13000=101.5 LIGNES   ...POUR 1 PLAN...!
;RESTE LA RECOPIE: LARGEMENT ASSEZ DE TEMPS POUR 1 PLAN.
;
;ALLEZ! C'EST PARTI:
*******************

	LEA	TABLE_256,A0
	LEA	BUF_COD,A1
	MOVE.L	A1,(A0)+
	MOVEQ	#0,D0

CONTINUE	MOVEQ	#0,D7	OFFSET
	MOVEQ	#0,D6
	;%00000001
	;        =BIT 0, BNE SAUTE
*TEST 1
TEST1	BTST	#7,D0
	BNE.S	.BIT_A_1
	;%0x
	BTST	#6,D0
	BNE.S	.BIT_A_1B
	;%00
	JMP	TEST2
.BIT_A_1B	;%01
	OR.B	#%00001111,D6
	JMP	TEST2
.BIT_A_1	;%1X
	BTST	#6,D0
	BNE.S	.BIT_A_1C
	;%10
	OR.B	#%11110000,D6
	JMP	TEST2
.BIT_A_1C	;%11
	OR.B	#%11111111,D6
*TEST2
TEST2	LSL	#8,D6
	BTST	#5,D0
	BNE.S	.BIT_A_1
	;%0x
	BTST	#4,D0
	BNE.S	.BIT_A_1B
	;%00
	JMP	TEST3
.BIT_A_1B	;%01
	OR.B	#%00001111,D6
	JMP	TEST3
.BIT_A_1	;%1X
	BTST	#4,D0
	BNE.S	.BIT_A_1C
	;%10
	OR.B	#%11110000,D6
	JMP	TEST3
.BIT_A_1C	;%11
	OR.B	#%11111111,D6
*TEST3
TEST3	;TST	D6
	;BEQ.S	NON
	MOVE	#$3D7C,(A1)+
	MOVE	D6,(A1)+
	MOVE	D7,(A1)+
NON	ADDQ	#8,D7
	MOVEQ	#0,D6
****
	BTST	#3,D0
	BNE.S	.BIT_A_1
	;%0x
	BTST	#2,D0
	BNE.S	.BIT_A_1B
	;%00
	JMP	TEST4
.BIT_A_1B	;%01
	OR.B	#%00001111,D6
	JMP	TEST4
.BIT_A_1	;%1X
	BTST	#2,D0
	BNE.S	.BIT_A_1C
	;%10
	OR.B	#%11110000,D6
	JMP	TEST4
.BIT_A_1C	;%11
	OR.B	#%11111111,D6
*TEST4
TEST4	LSL	#8,D6
	BTST	#1,D0
	BNE.S	.BIT_A_1
	;%0x
	BTST	#0,D0
	BNE.S	.BIT_A_1B
	;%00
	JMP	TEST5
.BIT_A_1B	;%01
	OR.B	#%00001111,D6
	JMP	TEST5
.BIT_A_1	;%1X
	BTST	#0,D0
	BNE.S	.BIT_A_1C
	;%10
	OR.B	#%11110000,D6
	JMP	TEST5
.BIT_A_1C	;%11
	OR.B	#%11111111,D6
*TEST5
TEST5	;TST	D6
	;BEQ.S	NON2
	MOVE	#$3D7C,(A1)+
	MOVE	D6,(A1)+
	MOVE	D7,(A1)+
NON2	ADDQ	#8,D7
	MOVEQ	#0,D6
	MOVE	#$4E75,(A1)+
	MOVE.L	A1,(A0)+
	ADDQ	#1,D0
	CMPI	#256,D0
	BNE	CONTINUE
FINI	NOP

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$014.W
	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	MOVE.L	#VBL,$70.W
B	BRA.S	B

VBL	SF	$FFFF8240.W
	;LEA	GFX_TRY,A0
	;MOVE.L	$44E.W,A0
	;LEA	160*100(A0),A0
	LEA	BUF_SCR,A0

	LEA	TABLE_256,A1
	MOVE.L	SCREEN2,A6
	MOVE	#50-1,D7
.DO_A_LINE
	MOVE.L	A0,A3
	REPT	10/2
	MOVEQ	#0,D0
	MOVE.B	(A0)+,D0	2
	ADD	D0,D0	1
	ADD	D0,D0	1
	MOVE.L	(A1,D0.W),A2
	JSR	(A2)	5?
	LEA	16(A6),A6

	MOVEQ	#0,D0
	MOVE.B	(A0),D0	2
	ADD	D0,D0	1
	ADD	D0,D0	1
	MOVE.L	(A1,D0.W),A2
	JSR	(A2)	5?
	LEA	16(A6),A6
	ADDQ	#7,A0
	ENDR
	MOVE.L	A3,A0
	LEA	160(A0),A0
	LEA	160*3(A6),A6
	DBF	D7,.DO_A_LINE
***
	MOVE.L	SCREEN2,A0
	LEA	160(A0),A1
	LEA	320(A0),A2
	LEA	480(A0),A3
	MOVE	#50-1,D7
.DO_A_Y
	REPT	20
	MOVE	(A0),D0
	MOVE	D0,(A1)
	MOVE	D0,(A2)
	MOVE	D0,(A3)
	ADDQ	#8,A0
	ADDQ	#8,A1
	ADDQ	#8,A2
	ADDQ	#8,A3
	ENDR
	LEA	160*3(A0),A0
	LEA	160*3(A1),A1
	LEA	160*3(A2),A2
	LEA	160*3(A3),A3
	DBF	D7,.DO_A_Y
***
	CMPI.B	#$F,$FFFFFC02.W
	BNE.S	.Q
	ST	$FFFF8240.W
.Q	
	CMPI.L	#8,NB_PART
	BNE	SUITV0
	BSR	TEST_LET
	CLR.L	NB_PART
SUITV0	BSR	SCROLL

	MOVE.L	SCREEN1,D0
	MOVE.L	SCREEN2,SCREEN1
	MOVE.L	D0,SCREEN2
	MOVE.B	SCREEN1+1,$FFFF8201.W
	MOVE.B	SCREEN1+2,$FFFF8203.W
	RTE
	
SCROLL	
	LEA	BUF_SCR,A0
	LEA	-2(A0),A0
	LEA	BUF_LET,A1
	REPT	8
	ROXL	(A1)

	ROXL	154(A0)
	ROXL	146(A0)
	ROXL	138(A0)
	ROXL	130(A0)
	ROXL	122(A0)
	ROXL	114(A0)
	ROXL	106(A0)
	ROXL	98(A0)
	ROXL	90(A0)
	ROXL	82(A0)
	ROXL	74(A0)
	ROXL	66(A0)
	ROXL	58(A0)	
	ROXL	50(A0)
	ROXL	42(A0)
	ROXL	34(A0)
	ROXL	26(A0)
	ROXL	18(A0)
	ROXL	10(A0)
	ROXL	2(A0)
	LEA	160(A0),A0
	ADDQ.L	#2,A1
	ENDR
	ADDI.L	#1,NB_PART
	RTS
NB_PART	DC.L	8
TEST_LET	MOVEQ	#0,D0
	LEA	TEXT1,A0	
	ADDA.L	POINT,A0
	LEA	FONT8_8,A1
	CMPI.B	#$FF,(A0)
	BNE	SUITTST
	CLR.L	POINT
	LEA	TEXT1,A0
SUITTST	MOVE.B	(A0),D0	
	SUBI.B	#32,D0	
	LSL.W	#3,D0	
	ADDA.L	D0,A1	
	LEA	BUF_LET,A2
	MOVE.B	(A1)+,(A2)
	MOVE.B	(A1)+,2(A2)
	MOVE.B	(A1)+,4(A2)
	MOVE.B	(A1)+,6(A2)
	MOVE.B	(A1)+,8(A2)
	MOVE.B	(A1)+,10(A2)
	MOVE.B	(A1)+,12(A2)
	MOVE.B	(A1)+,14(A2)
	ADDI.L	#1,POINT
	RTS
	
TEXT1
 DC.B "BELIEVE IT OR NOT BUT THIS IS A REALTIME ONE-PLANE ZOOMER!   CODED BY ZAPPY OF HOLOCAUST.  NOT REALLY IMPRESSIVE, EH... "
 DC.B " BUT I WASN'T ABLE TO SLEEP...  SORRY...... "
	DC.B $FF
	EVEN
FONT8_8	
;FONTS_1
	DC.B	0,0,0,0,0,0,0,0
	DC.B 24,24,48,48,0,96,96,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B 24,24,48,0,0,0,0,0
	DC.B 24,56,48,48,48,56,24,0
	DC.B 48,56,24,24,24,56,48,0
	DC.B 18,84,56,254,56,84,144,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B 0,0,0,0,48,48,96,0
	DC.B 0,0,0,126,126,0,0,0
	DC.B 0,0,0,0,0,48,48,0
	DC.B 254,0,252,0,248,0,240,0
	DC.B 124,198,206,214,230,198,124,0
	DC.B 24,56,56,24,24,60,60,0
	DC.B 60,94,102,12,24,54,126,0
	DC.B 126,126,6,28,6,126,124,0
	DC.B 28,60,108,204,254,254,12,0
	DC.B 126,126,64,124,6,126,124,0
	DC.B 60,102,96,124,102,102,60,0
	DC.B 126,118,76,12,24,24,24,0
	DC.B 60,102,102,60,102,102,60,0
	DC.B 60,102,102,62,6,6,60,0
	DC.B 0,0,48,48,0,48,48,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	60,102,102,12,0,24,24,0
	DC.B	0,0,0,0,0,0,0,0

	DC.B	124,230,230,254,230,230,230,0	;A
	DC.B	252,230,230,252,230,230,252,0	;B
	DC.B	124,230,224,224,224,230,124,0	;C
	DC.B	252,230,230,230,230,230,252,0	;D
	DC.B	254,224,224,248,224,224,254,0	;E
	DC.B	254,224,224,248,224,224,224,0	;F
	DC.B	124,230,224,224,238,230,124,0	;G
	DC.B	230,230,230,254,230,230,230,0	;H
	DC.B	124,56,56,56,56,56,124,0	;I
	DC.B	14,14,14,14,14,206,124,0	;J
	DC.B	230,238,252,248,252,238,230,0	;K
	DC.B	224,224,224,224,224,224,254,0	;L
	DC.B	198,238,246,230,230,230,230,0	;M
	DC.B	252,230,230,230,230,230,230,0	;N
	DC.B	124,230,230,230,230,230,124,0	;O
	DC.B	252,230,230,252,224,224,224,0	;P
	DC.B	121,230,230,230,238,252,118,0	;Q
	DC.B	252,230,230,252,236,230,230,0	;R
	DC.B	124,230,224,124,14,206,124,0	;S
	DC.B	254,56,56,56,56,56,56,0	;T
	DC.B	230,230,230,230,230,230,124,0	;U
	DC.B	230,230,230,230,230,124,56,0	;V
	DC.B	230,230,230,230,254,238,198,0	;W
	DC.B	198,238,124,56,124,238,198,0	;X
	DC.B	230,230,230,124,56,56,56,0	;Y
	DC.B	254,206,28,56,112,230,254,0	;Z

POINT	DS.L	1
BUF_LET	DS.B	(1*8)*2

FIN	MOVE.L	4.W,A0
	JMP	(A0)
	DATA
GFX_TRY	
	DCB.B	80*50,%11111111

	DC.B	%11111111
	DC.B	%00000011
	DC.B	%00000110
	DC.B	%00001100
	DC.B	%00011000
	DC.B	%00110000
	DC.B	%01100000
	DC.B	%11111111

	BSS
TABLE_256	DS.L	256+2
BUF_COD	DS.B	10000
BUF_SCR	DS.B	160*50
SCREEN1	DS.L	1
SCREEN2	DS.L	1
	DS.B	256
BUFFER	DS.B	64000