	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP	

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$014.W

*DEPART: 2 TABLEAUX : Xs DE LA VBL PRECEDENTE
*	       Xs DE LA VBL EN COURS

	MOVE.L	#VBL,$70.W
K	JMP	K

VBL	SF	$FFFF8240.W
	MOVE.L	$44E.W,A6
	MOVE.L	#$FFFFFFFF,D3
	LEA	TABLO1,A0
	LEA	TABLO2,A1
	LEA	TABLE1,A2
	LEA	TABLE2,A3
;	LEA	TABLE3,A4
	MOVE	#200-1,D7
BOUCLE	LEA	1601111111111111110000,N
	DC.L	%11111111111111111111111111111000,N
	DC.L	%11111111111111111111111111111100,N
	DC.L	%11111111111111111111111111111110,N
	DC.L	%11111111111111111111111111111111,N

N	SET	N+16
	ENDR


	BSS
TABLE	DS.L	20
CODE	DS.B	900NE.S	KS
	ST	$FFFF8240.W
KS	RTE
FIN	MOVE.L	4.W,A0
	JMP	(A0)
AFFICHE	
;	SUBQ	#1,D2

	MOVE	D2,D1
	MOVE	D0,D4

	LSR	#4,D1
	LSR	#4,D4
	SUB	D1,D4
	BNE.S	PAS_LE_MEME_MOT

;	MOVE	D1,D2
;	MOVE	D4,D0

	ADD	D2,D2	x3*4 ( x3<x1 )
	ADD	D2,D2
	MOVE	(A2;FILL - Version 7: MOVEs/une routine par Dx et par d‚calage.

	CLR.L	-(SP)
	MOVE	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	
	CLR	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP	

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W
	MOVE.L	#FIN,$014.W

	move.l	#BUFFER,d0
	CLR.B	D0
	move.l	d0,SCREEN1		
	add.l	#32000,d0		
	move.l	d0,SCREEN2
	
	LEA	CODE,A0
	LEA	TABLE,A1
	MOVE.L	A0,(A1)+
	LEA	TABLO,A6
	MOVE	#%1000000000000000,(A6)
	MOVE	#%0100000000000000,D6

ANEW	LEA	TABLO,A6
	LEA	TABLO_COPIE,A5
	REPT	10
	MOVE.L	(A6)+,(A5)+
	ENDR

AGAIN	LEA	TABLO,A6
	MOVEQ	#0,D7
	
VIDE	MOVE	(A6)+,D0
	BEQ.S	VIDE
	CMPI	#$9999,D0
	BEQ.S	GNR

	CMPI	#$FFFF,D0
	BNE.S	NON_PLEIN

	TST	D7
	BEQ.S	DEBUT_DE_LIGNE
	MOVE	#$3141,(A0)+
	MOVE	D7,(A0)+
	ADDQ	#8,D7
	BRA.S	SUIT0
DEBUT_DE_LIGNE	MOVE	#$3081,(A0)+
	ADDQ	#8,D7
	BRA.S	SUIT0

NON_PLEIN	TST	D7
	BEQ.S	DEB_LINE

	MOVE	#$317C,(A0)+
	MOVE	D0,(A0)+
	MOVE	D7,(A0)+
	ADDQ	#8,D7
	BRA.S	SUIT0
DEB_LINE	MOVE	#$30BC,(A0)+
	MOVE	D0,(A0)+
	ADDQ	#8,D7

SUIT0	BRA.S	VIDE
	
GNR	MOVE	#$4E75,(A0)+
	MOVE.L	A0,(A1)+
	LEA	TABLO,A6
N	SET	0
	REPT	20
	ROXR	N(A6)
N	SET	N+2
	ENDR

	ADDQ.L	#1,CNT
	CMPI.L	#16,CNT
	BNE	AGAIN
	CLR.L	CNT
	LEA	TABLO,A5
	LEA	TABLO_COPIE,A6
	REPT	10
	MOVE.L	(A6)+,(A5)+
	ENDR
	LEA	TABLO,A6
MODX	EQU	*+2
	LEA	0(A6),A6
	OR	D6,(A6)
	LSR	#1,D6
	BNE	ANEW
	MOVE	#%1000000000000000,D6
	ADDQ	#2,MODX
	CMPI	#40,MODX
	BEQ.S	FINITO
	BRA	ANEW
	
FINITO	NOP



	MOVE.L	#VBL,$70.W
H	BRA.S	H
FIN	MOVE.L	4.W,A0
	JMP	(A0)
VBL	SF	$FFFF8240.W
;	BRA	T
	MOVE.L	SCREEN2,A6
	moveq	#0,d0
	MOVE	#199,D1
EFF
N	SET	0
	REPT	20
	MOVE	D0,N(A6)
N	SET	N+8
	ENDR
	LEA	160(A6),A6
	DBF	D1,EFF

T	MOVE	#$001,$FFFF8240.W

	MOVE.L	SCREEN2,A6
	MOVE.L	#$FFFFFFFF,D1

	LEA	TABL,A3
	LEA	TABL2,A2
	LEA	TABLE,A4

	MOVE	#